<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIS BCW - ‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1e56a0; --bg: #f3f5f9; }
        body { font-family: 'Prompt', sans-serif; background-color: var(--bg); margin: 0; padding: 0; padding-bottom: 80px; }
        .navbar { background: var(--primary); color: white; padding: 15px; position: sticky; top: 0; z-index: 1000; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1);}
        .container { max-width: 900px; margin: 20px auto; padding: 0 15px; }
        .page { display: none; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }
        .card { background: #fff; border-radius: 12px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); margin-bottom: 20px; }
        
        /* ‡πÄ‡∏°‡∏ô‡∏π / ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÜ */
        .nav-menu { position: fixed; bottom: 0; width: 100%; background: white; display: none; justify-content: space-around; padding: 10px 0; border-top: 1px solid #ddd; z-index: 1000;}
        .nav-item { text-align: center; font-size: 13px; color: #64748b; cursor: pointer; flex: 1; }
        .nav-item.active { color: var(--primary); font-weight: bold; }
        input, select { padding: 10px; border: 1px solid #ccc; border-radius: 8px; font-family: 'Prompt'; width: 100%; box-sizing: border-box; margin-bottom: 10px;}
        button { padding: 10px 15px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-family: 'Prompt'; font-weight: bold;}
        
        /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ */
        table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 14px; background: white;}
        th, td { padding: 10px; border-bottom: 1px solid #eee; text-align: left; }
        th { background: #f8f9fa; }
        
        /* Exec Dashboard Stats */
        .stat-grid { display: flex; gap: 10px; margin-bottom: 20px; }
        .stat-card { flex: 1; padding: 20px; border-radius: 10px; color: white; text-align: center; }
        .stat-blue { background: linear-gradient(135deg, #1e56a0, #2a6fcc); }
        .stat-green { background: linear-gradient(135deg, #28a745, #34ce57); }
        .stat-red { background: linear-gradient(135deg, #dc3545, #e4606d); }
        .stat-card h3 { margin: 0; font-size: 14px; opacity: 0.9; }
        .stat-card h2 { margin: 5px 0 0 0; font-size: 28px; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div class="navbar">
    <div style="font-weight: bold;">üè´ SIS ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</div>
    <div id="user-display" style="font-size: 12px; cursor: pointer;" onclick="logout()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</div>
</div>

<div class="container">
    
    <div id="login-page" class="page active">
        <div class="card" style="text-align: center; max-width: 400px; margin: 40px auto;">
            <h2 style="color: #1e56a0;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
            <input type="text" id="username" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡πÄ‡∏ä‡πà‡∏ô t01, admin, boss)">
            <input type="password" id="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
            <button id="login-btn" onclick="handleLogin()" style="width: 100%;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>
    </div>

    <div id="teacher-view" class="page">
        <h2 style="color:var(--primary);">üë©‚Äçüè´ ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏£‡∏π‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ä‡∏±‡πâ‡∏ô <span id="class-title"></span></h2>
        <div class="card" style="text-align:center;">
            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</p>
            <button onclick="alert('‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏±‡∏ö (‡∏ú‡∏°‡∏¢‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏ü‡∏Å‡∏±‡∏™ Admin/Exec)')">‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</button>
        </div>
    </div>

    <div id="admin-page" class="page">
        <h2 style="color: #1e56a0;">‚öôÔ∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö (Admin)</h2>
        
        <div class="card">
            <h3>üìÖ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</h3>
            <div style="display:flex; gap:10px;">
                <div style="flex:1"><label>‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</label><input type="date" id="admin-start"></div>
                <div style="flex:1"><label>‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label><input type="date" id="admin-end"></div>
            </div>
        </div>

        <div class="card">
            <h3>üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡∏Ñ‡∏£‡∏π)</h3>
            <p style="font-size:12px; color:#666;">* ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</p>
            <div style="overflow-x: auto;">
                <table id="admin-users-table">
                    <thead><tr><th>Username</th><th>Password</th><th>Role</th><th>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th><th>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ä‡∏±‡πâ‡∏ô</th><th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr></thead>
                    <tbody id="admin-users-body"></tbody>
                </table>
            </div>
            <button onclick="addUserRow()" style="margin-top:10px; background:#28a745;">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏£‡∏π</button>
        </div>

        <div class="card">
            <h3>üéì ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
            <div style="overflow-x: auto;">
                <table id="admin-students-table">
                    <thead><tr><th>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</th><th>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th><th>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th><th>‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th><th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr></thead>
                    <tbody id="admin-students-body"></tbody>
                </table>
            </div>
            <button onclick="addStudentRow()" style="margin-top:10px; background:#28a745;">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
        </div>

        <button onclick="saveAdminData()" style="width:100%; padding:15px; font-size:18px; margin-bottom: 20px;">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    </div>

    <div id="exec-page" class="page">
        <h2 style="color: #1e56a0;">üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ (Executive)</h2>
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
            <b>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô:</b>
            <input type="date" id="exec-date" style="width: auto; margin:0;" onchange="loadExecReport()">
        </div>

        <div class="stat-grid">
            <div class="stat-card stat-blue">
                <h3>‡∏ô‡∏£. ‡∏ó‡∏±‡πâ‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                <h2 id="exec-total">0</h2>
            </div>
            <div class="stat-card stat-green">
                <h3>‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>
                <h2 id="exec-present">0</h2>
            </div>
            <div class="stat-card stat-red">
                <h3>‡∏Ç‡∏≤‡∏î/‡∏•‡∏≤/‡∏õ‡πà‡∏ß‡∏¢</h3>
                <h2 id="exec-absent">0</h2>
            </div>
        </div>

        <div class="card">
            <h3>üìà ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏≤‡∏¢‡∏´‡πâ‡∏≠‡∏á (‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô)</h3>
            <table>
                <thead>
                    <tr><th>‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th><th style="color:green;">‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th><th style="color:red;">‡∏Ç‡∏≤‡∏î</th><th style="color:orange;">‡∏õ‡πà‡∏ß‡∏¢/‡∏•‡∏≤</th></tr>
                </thead>
                <tbody id="exec-class-body">
                    <tr><td colspan='4' style='text-align:center;'>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

</div>

<script>
    const GAS_API_URL = "https://script.google.com/macros/s/‡πÉ‡∏™‡πà_URL_‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ/exec";
    
    document.getElementById('exec-date').valueAsDate = new Date();

    let adminUsers = [];
    let adminStudents = [];

    // --- üîê ‡∏£‡∏∞‡∏ö‡∏ö Login (‡πÅ‡∏¢‡∏Å Role) ---
    function handleLogin() {
        const u = document.getElementById('username').value.trim();
        const p = document.getElementById('password').value.trim();
        const btn = document.getElementById('login-btn');
        if (!u || !p) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô"); return; }

        btn.innerText = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...";
        btn.disabled = true;

        fetch(`${GAS_API_URL}?action=login&user=${encodeURIComponent(u)}&pass=${encodeURIComponent(p)}`)
            .then(res => res.json())
            .then(data => {
                btn.innerText = "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö";
                btn.disabled = false;
                if (data.status === "success") {
                    document.getElementById('user-display').innerText = `${data.name} - ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö`;
                    
                    if (data.role === "admin") {
                        switchPage('admin-page');
                        loadAdminData(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏Å‡πâ
                    } else if (data.role === "executive" || data.role === "boss") {
                        switchPage('exec-page');
                        loadExecReport(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏£‡∏≤‡∏ü‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£
                    } else if (data.role === "teacher") {
                        document.getElementById('class-title').innerText = `(${data.className})`;
                        switchPage('teacher-view');
                        // (‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà)
                    }
                } else { alert("‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"); }
            }).catch(err => { btn.innerText = "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö"; btn.disabled = false; });
    }

    function logout() { location.reload(); }
    function switchPage(pageId) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
    }

    // ==========================================
    // ‚öôÔ∏è ‡πÇ‡∏´‡∏°‡∏î ADMIN (‡∏î‡∏∂‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
    // ==========================================
    function loadAdminData() {
        fetch(`${GAS_API_URL}?action=get_admin_data`)
            .then(res => res.json())
            .then(data => {
                if(data.status === "success") {
                    document.getElementById('admin-start').value = data.config.startDate;
                    document.getElementById('admin-end').value = data.config.endDate;
                    
                    let uBody = document.getElementById('admin-users-body');
                    uBody.innerHTML = "";
                    data.users.forEach((u, i) => {
                        uBody.innerHTML += `<tr>
                            <td><input type="text" value="${u[0]}" id="u-user-${i}"></td>
                            <td><input type="text" value="${u[1]}" id="u-pass-${i}"></td>
                            <td><select id="u-role-${i}">
                                <option value="teacher" ${u[2]=='teacher'?'selected':''}>Teacher</option>
                                <option value="admin" ${u[2]=='admin'?'selected':''}>Admin</option>
                                <option value="executive" ${u[2]=='executive'?'selected':''}>Executive</option>
                            </select></td>
                            <td><input type="text" value="${u[3]}" id="u-name-${i}"></td>
                            <td><input type="text" value="${u[4]||''}" id="u-class-${i}"></td>
                            <td><button style="background:red;" onclick="this.parentElement.parentElement.remove()">‡∏•‡∏ö</button></td>
                        </tr>`;
                    });

                    let sBody = document.getElementById('admin-students-body');
                    sBody.innerHTML = "";
                    data.students.forEach((s, i) => {
                        sBody.innerHTML += `<tr>
                            <td><input type="text" value="${s[0]}" id="s-num-${i}" style="width:50px;"></td>
                            <td><input type="text" value="${s[1]}" id="s-id-${i}"></td>
                            <td><input type="text" value="${s[2]}" id="s-name-${i}"></td>
                            <td><input type="text" value="${s[3]}" id="s-class-${i}"></td>
                            <td><button style="background:red;" onclick="this.parentElement.parentElement.remove()">‡∏•‡∏ö</button></td>
                        </tr>`;
                    });
                }
            });
    }

    function addUserRow() {
        let i = Date.now(); // ‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏≠‡∏î‡∏µ
        document.getElementById('admin-users-body').innerHTML += `<tr>
            <td><input type="text" id="u-user-${i}"></td>
            <td><input type="text" id="u-pass-${i}"></td>
            <td><select id="u-role-${i}"><option value="teacher">Teacher</option></select></td>
            <td><input type="text" id="u-name-${i}"></td>
            <td><input type="text" id="u-class-${i}"></td>
            <td><button style="background:red;" onclick="this.parentElement.parentElement.remove()">‡∏•‡∏ö</button></td>
        </tr>`;
    }

    function addStudentRow() {
        let i = Date.now();
        document.getElementById('admin-students-body').innerHTML += `<tr>
            <td><input type="text" id="s-num-${i}" style="width:50px;"></td>
            <td><input type="text" id="s-id-${i}"></td>
            <td><input type="text" id="s-name-${i}"></td>
            <td><input type="text" id="s-class-${i}"></td>
            <td><button style="background:red;" onclick="this.parentElement.parentElement.remove()">‡∏•‡∏ö</button></td>
        </tr>`;
    }

    function saveAdminData() {
        let btn = document.querySelector('#admin-page > button');
        btn.innerText = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";

        let users = [], students = [];
        document.querySelectorAll('#admin-users-body tr').forEach(tr => {
            let inputs = tr.querySelectorAll('input, select');
            users.push([inputs[0].value, inputs[1].value, inputs[2].value, inputs[3].value, inputs[4].value]);
        });
        document.querySelectorAll('#admin-students-body tr').forEach(tr => {
            let inputs = tr.querySelectorAll('input');
            students.push([inputs[0].value, inputs[1].value, inputs[2].value, inputs[3].value]);
        });

        let payload = {
            action: "admin_update",
            settings: {
                startDate: document.getElementById('admin-start').value,
                endDate: document.getElementById('admin-end').value
            },
            users: users,
            students: students
        };

        fetch(GAS_API_URL, { method: "POST", body: JSON.stringify(payload) })
        .then(res => res.json())
        .then(data => {
            btn.innerText = "üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î";
            if(data.status === "success") alert("‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
        });
    }

    // ==========================================
    // üìä ‡πÇ‡∏´‡∏°‡∏î EXECUTIVE (‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£)
    // ==========================================
    function loadExecReport() {
        let date = document.getElementById('exec-date').value;
        fetch(`${GAS_API_URL}?action=get_exec_report&date=${date}`)
            .then(res => res.json())
            .then(data => {
                if(data.status === "success") {
                    document.getElementById('exec-total').innerText = data.data.total_students;
                    document.getElementById('exec-present').innerText = data.data.present_today;
                    document.getElementById('exec-absent').innerText = data.data.absent_today;
                    
                    let tbody = document.getElementById('exec-class-body');
                    tbody.innerHTML = "";
                    let classes = data.data.classes;
                    
                    if(Object.keys(classes).length === 0) {
                        tbody.innerHTML = `<tr><td colspan='4' style='text-align:center;'>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</td></tr>`;
                    } else {
                        for(let cName in classes) {
                            tbody.innerHTML += `<tr>
                                <td><b>${cName}</b></td>
                                <td style="color:green; font-weight:bold;">${classes[cName].present}</td>
                                <td style="color:red;">${classes[cName].absent}</td>
                                <td style="color:orange;">${classes[cName].sick + classes[cName].leave}</td>
                            </tr>`;
                        }
                    }
                }
            });
    }
</script>

</body>
</html>
